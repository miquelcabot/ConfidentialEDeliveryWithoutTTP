# -*- coding: utf-8 -*-
p = 0x858c3268fdee96427a1fa7d0ef76fc922eee0287b05bcc66e3b1ab2bef199aa87ff3f22c556ed37ad144676be663cd3cfd7ec673572b5db235478ac703fb0eab
g = 0x6f2906fe9db37da42704433d3b9cf0c65cbbc1ba2b5e14021f5bbcbd0243da4ca919208d60af3c646c6a5acbd2586e6ece55f10751c4f855c3bfb12ff41a7e41
xa = 0x3bf8967871462f3d55b8b72e5157868d6aed3478a494d8d407e223e6d1d350e9627607520a328332ef12dac0f71047ddfcaeb566ac68329a359b888c20abc6ad
ya = pow(g, xa, p)
print("ya? "+str(ya==0x5c8c0fe913be59311b3297f95dfd3a8adf9d766392545a35c895dee3d111d16ed8a13790b37683400f25d6070c46483ce902af8e5b7fb8ea3b92df36ba2678d8))
r = 0x161b42bfced816d30fd39a14eccaff6aae44a3ffc78509e758356bfbc9ca406b05ced9b16df6c6dfe633499c2ee9a78eed8f71138b3d4284e3d516bf08171b48
c = 0x3a4dd9ac22891c9c7738f74d3ad8432d11e9d7649c27c94c34b41e1f8263e67481e820d68c725765a663a38bc74d1e87ae3adb7cd82e72398269480de1504ae8
s = 0x23c16404c89d1db8749f6d3e7c620e54747de1fb08c67531287d438660c104d2e5b8286c435e625289d5bedd6234a05ca80407402ec899c656ee1aca4679fd85
xb = 0x3554f0476646c2244b390f6e427d05d7ce73ba13cf393cf4e2918ef9ce9b1e3cc430777432933aae2f08a2542e3efad20d7b8c7ab941840cb988e8401fdf147b
yb = pow(g, xb, p)
print("yb= "+str(yb==0x357b8bb3e447ef2bd9b8bb54e35a1b3b9016f6bab27aba55717fd4d3e01e6ff9875dbcb3edec6cba45baf8ab90496464d497b1d40848b8f30293456dcbadbe7a))
z1 = pow(g, s, p)
print("z1? "+str(z1==0x5924a61445b0cb24eed4c5a888f167f38c794c78ae123c90b69907acea951623ccc7588fb5792b5a7a77ba4e5c4c90a563ed0f51b677aba240e81ab918cfc7b8))
# z2 = xb·ya^s mod p
z2 = (xb* pow(ya, s, p))
print z2
print ("z2? "+str(z2==0x1706ecdc1efcabb681dc5892ecadb5e6e5135ca606a0b55100faa73a4377cf008d4ca265373590c9961e219fdc0f452824e5e190ec0947c894f2f8dced719faaf55e34b24d62abe072facbd23cdaa9d785685bc0ec02767656f2bdcdb5346c15f007b8f67900e62ebd71ae98f529ef46b1c24a0b1485afd037fda3046046a83e))
# w = r + c·xb mod p
w = r + c * (xb % p)
print ("w? "+str(w==0xc2576554e95994344bc77f21a35fc472f66d165ce667e2fc877156f0b680d9b3dff7779e6b0f5f4e0bedb0b3b8bee8238320ca63a87b0baaf99be6bca8eecc4410a4571bdf1872fdf4bcee6219831fa1af1dc5cf7ce620db58eed648f505b19515e6224904e328f1af779fd789fb7d2b5f8f7b6777a6f18c3a0c307e79d38c0))
# AAA = g^w mod p
# BBB = ((g^r mod p)·(yb^c mod p)) mod p
aaa = pow(g, w, p)
bbb = (pow(g,r,p)*pow(yb,c,p)) % p
print aaa
print bbb
print aaa==bbb
